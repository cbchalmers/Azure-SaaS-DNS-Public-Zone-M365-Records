# Project Title

Host your public DNS records on an Azure DNS Zone

## Description

Provision an Azure DNS Zone to host your public DNS records which are required for Microsoft 365; covering Exchange Online, Microsoft Teams and Skype for Business, and Mobile Device Management for Office 365. Intention of this project is to have the DNS records configuration managed. 

#### Resources Provisioned

* Public DNS Zone
* CNAME, MX, SRV and TXT Records Required for Microsoft 365

### Prerequisites

* [Download and Install Terraform](https://www.terraform.io/downloads.html)
* [Create a Service Principal for Terraform](https://www.terraform.io/docs/providers/azurerm/guides/service_principal_client_secret.html#creating-a-service-principal)

### Installing

* Populate client_id and client_secret inside global_main.tf from the Service Principal you created in the prerequisites
* Populate subscription_id and tenant_id inside global_main.tf from your Azure tenant information
* Populate resource_location inside global_vars.tf with your desired location to provision the resources. Eg UK South
* Populate resource_prefix inside global_vars.tf with your desired prefix for the provisioned resources. Eg CC-D-UKS
* Populate domain_name inside global_vars.tf with your public Domain name
* Populate exchange_url inside global_vars.tf with your unique MX record. You can find this on [Microsoft 365 Admin Center > Domains](https://admin.microsoft.com/Adminportal/Home?source=applauncher#/Domains)

The [terraform init](https://www.terraform.io/docs/commands/init.html)  command is used to initialize a working directory containing Terraform configuration files. This is the first command that should be run after writing a new Terraform configuration or cloning an existing one from version control. It is safe to run this command multiple times

```
terraform init
```

The [terraform plan](https://www.terraform.io/docs/commands/plan.html) command is used to create an execution plan. Terraform performs a refresh, unless explicitly disabled, and then determines what actions are necessary to achieve the desired state specified in the configuration files. This command is a convenient way to check whether the execution plan for a set of changes matches your expectations without making any changes to real resources or to the state. For example, terraform plan might be run before committing a change to version control, to create confidence that it will behave as expected.

```
terraform plan
```

The [terraform apply](https://www.terraform.io/docs/commands/apply.html) command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan.

```
terraform apply
```

Update your Domain Registrar to use the Azure Name Servers that are provided to you within thee DNS Zone. eg ns1-08.azure-dns.com, ns2-08.azure-dns.net, ns3-08.azure-dns.org and ns4-08.azure-dns.info. They are randomly assigned as you provision the zone. 

### Removing

The [terraform destroy](https://www.terraform.io/docs/commands/destroy.html) command is used to destroy the Terraform-managed infrastructure.

```
terraform destroy
```

## Built With

* [Terraform Azure RM Provider](https://www.terraform.io/docs/providers/azurerm/index.html)

## References

* [Terraform Commands](https://www.terraform.io/docs/commands/index.html)
* [Terraform Azure RM Provider](https://www.terraform.io/docs/providers/azurerm/index.html)
* [Create DNS records for Azure DNS Zones](https://docs.microsoft.com/en-gb/microsoft-365/admin/dns/create-dns-records-for-azure-dns-zones?view=o365-worldwide#BKMK_add_SRV)

## Authors

Chris Chalmers - [LinkedIn](https://uk.linkedin.com/in/chris-chalmers)